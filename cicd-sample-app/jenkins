properties([pipelineTriggers([pollSCM('* * * * *')])])

pipeline {
  agent any
// agent any → Voer de pipeline uit op eender welke vrije Jenkins-machine

  stages {
    stage('Preparation') {
      steps {
        sh 'docker rm -f samplerunning || true'
      }
    }

    stage('Build') {
      steps {
        build job: 'BuildSampleApp', wait: true, propagate: true
      }
    }
// wait: true: wacht tot die job klaar is
// propagate: true → Als die job faalt, faalt de hele pipeline meteen ook.

    stage('Results') {
      steps {
        build job: 'TestSampleApp', wait: true, propagate: true
      }
    }
  }
}

// node {
//     stage('Preparation') {
//         catchError(buildResult: 'SUCCESS') {
//             sh 'docker stop samplerunning'
//             sh 'docker rm samplerunning'
//         }
//     }
//     stage('Build') {
//         build 'BuildSampleApp'
//     }
//     stage('Results') {
//         build 'TestSampleApp'
//     }
// }
