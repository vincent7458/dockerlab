node {
  stage('SCM sanity') {
    sh '''
      echo "Branch:" && git rev-parse --abbrev-ref HEAD || true
      echo "Last commit:" && git log -1 --oneline || true
      echo "CSS line:" && grep -n "background-color" cicd-sample-app/static/style.css || true
    '''
  }
  stage('Preparation') {
    sh 'docker rm -f samplerunning || true'
  }
  stage('Build') { build 'BuildSampleApp' }
  stage('Results') { build 'TestSampleApp' }
}
